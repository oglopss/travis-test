# Using container-based infrastructure
# sudo: false
# enable trusty beta
sudo: required
dist: trusty

# 'bash' will define a generic environment without interfering environment
# settings like "CC=gcc"
language: bash

# Only build the master branch
branches:
    only:
        - master

# Caching the downloaded src packages between several builds to save travis-ci
# download time and bandwidth
cache:
    directories:
        - $HOME/src
        - $HOME/x-tools
        - $HOME/zlib-install
        - $HOME/openssl-install

# Installing needed dependencies
addons:
    apt:
        packages:
            - bison
            - flex
            - gperf
            - libncurses5-dev
            - texinfo
            - help2man
            # - openssl
            # - zlib
            
# Handle git submodules yourself
git:
    submodules: false
    
# Use sed to replace the SSH URL with the public URL, then initialize submodules
# before_install:
#     - sed -i 's/git@github.com:/https:\/\/github.com\//' .gitmodules
#     - git submodule update --init --recursive
    
# Building crosstool-NG core
# install:
#     - cd crosstool-ng
#     - git checkout tags/crosstool-ng-1.21.0
#     - cp $TRAVIS_BUILD_DIR/ctng.config ./.config -f
#     - ./bootstrap
#     - ./configure --enable-local
#     - make
#     - make install

# Here is the list of all the standard samples tracked
# by the continuous integration system
env:
    # - CT_SAMPLE=mipsel-unknown-linux-gnu
    matrix:
        # - export PATH=$HOME/x-tools/mipsel-unknown-linux-uclibc/bin:$PATH
        - SS_VER=v2.4.5
        - SS_VER=v2.4.1
        - SS_VER=v2.3.1
        # - SS_VER=v2.4.5
    global:
        - secure: ia+DDKsGsVyzsmQElKUQDja8xRt0M5WlZ3WUiXKpNparvs5nJ6XrfKldzOJRAwKQZlDZQevzal1x8rt7Gj2Zm6FdV6blM8BA4TNCJYnkxFCpkR9BEo0HlaX4QZChBiJlOk3ecnmVnB8vA6B1V7gOnSbvOJ0NX9zBgGFxbbrqtRhAfaAgvOi7W3KANb2OZ6hBzXM2tW13x2VArI69svV/I85pwbxllsQ4ed85o/Uaxzuu1eenf1EoT9qxxBU46y/6CR6LAvJ/J2OUL6J4XGJ6lSbXnEReqCEVelt5m+OM+FiTurs05NLcXJeBsQpOcOaKRi8U7vlz4/se2faEW+3lVOXoKDSJPtML8Y7H5X4+OdHm217Rc1/SbMzCA8uV3fLZ7VtW3gMifRQ5aWonfX0LhVDhCCuIxOghKjzWG3AEl5kjWf1Av6w/MLMzFsZey5EHtpe98XYGhpo9Lnp1Q4fzhY+wa7v6+r+taIdKzZpIacoPh0FwZv7qbxNy5Q7/wIvr/D5ocTTTNliistDRozesberGK8cHPmJDa1qzTe4aL3qUy8X56zQaXRyfO/20ciQyUcdoW8iaTenpfNmgxqNe8YQ9FyVY+Znx1j72NNmTKNAGrLYTA5J7q/Flzzfll2yjRLUA8q1SwfptSP7FzkR0w2A6gDs/zUSkdqMMj5NAuoI=
        
        
# Building the standard samples
script:
    # - . ls -l $HOME
    - . $TRAVIS_BUILD_DIR/update-gh-pages.sh      # Load the travis environment
    # - ct-ng $CT_SAMPLE    # Configure the build
    # - ct-ng_travis_build  # Build the sample
    # - zlib_build
    # - openssl_build
    # - ss_build
    # - test

# On failure displaying the last lines of the log file
# after_failure:
#     - tail -n 1000 $TRAVIS_BUILD_DIR/config/build.log

# after_success: . $TRAVIS_BUILD_DIR/update-gh-pages.sh
